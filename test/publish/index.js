!function(){var h=require("./jquery"),g=require("./html-docx.min.js");if(void 0!==h){var p=p||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(g){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var p=g.document,w=function(){return g.URL||g.webkitURL||g},v=p.createElementNS("http://www.w3.org/1999/xhtml","a"),y=!g.externalHost&&"download"in v,b=g.webkitRequestFileSystem,x=g.requestFileSystem||b||g.mozRequestFileSystem,i=function(e){(g.setImmediate||g.setTimeout)(function(){throw e},0)},E="application/octet-stream",R=0,S=[],e=function(){for(var e=S.length;e--;){var t=S[e];"string"==typeof t?w().revokeObjectURL(t):t.remove()}S.length=0},O=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){i(e)}}},n=function(r,n){function e(){var e=w().createObjectURL(r);return S.push(e),e}function t(){O(s,"writestart progress write writeend".split(" "))}function o(){!m&&a||(a=e()),l?l.location.href=a:window.open(a,"_blank"),s.readyState=s.DONE,t()}function i(e){return function(){if(s.readyState!==s.DONE)return e.apply(this,arguments)}}var a,l,d,c,f,s=this,u=r.type,m=!1,h={create:!0,exclusive:!1};if(s.readyState=s.INIT,n=n||"download",y)return a=e(),v.href=a,v.download=n,c=v,(f=p.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,g,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(f),s.readyState=s.DONE,void t();g.chrome&&u&&u!==E&&(d=r.slice||r.webkitSlice,r=d.call(r,0,r.size,E),m=!0),b&&"download"!==n&&(n+=".download"),u!==E&&!b||(l=g),x?(R+=r.size,x(g.TEMPORARY,R,i(function(e){e.root.getDirectory("saved",h,i(function(e){function t(){e.getFile(n,h,i(function(n){n.createWriter(i(function(t){t.onwriteend=function(e){l.location.href=n.toURL(),S.push(n),s.readyState=s.DONE,O(s,"writeend",e)},t.onerror=function(){var e=t.error;e.code!==e.ABORT_ERR&&o()},"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=s["on"+e]}),t.write(r),s.abort=function(){t.abort(),s.readyState=s.DONE},s.readyState=s.WRITING}),o)}),o)}e.getFile(n,{create:!1},i(function(e){e.remove(),t()}),i(function(e){(e.code===e.NOT_FOUND_ERR?t:o)()}))}),o)}),o)):o()},t=n.prototype,r=function(e,t){return new n(e,t)};return t.abort=function(){this.readyState=this.DONE,O(this,"abort")},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,g.addEventListener("unload",e,!1),r.unload=function(){e(),g.removeEventListener("unload",e,!1)},r}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&null!==module?module.exports=p:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return p}),"undefined"!=typeof module&&null!==module?module.exports=e:"undefined"!=typeof define&&null!==define&&null!=define.amd?define([],function(){return e}):"undefined"!=typeof window&&(window.HtmlToDocx=e)}else console.error("please require the jquery");function e(e){var t,n,r,o=e.exportElement,i=e.exportFileName,a=e.StringStyle?e.StringStyle:"#main,\t#main1 {height: 400px;width: 630px\t}\t.list {background: blue;padding: 10px\t}\t.list .page {background: yellow;padding: 5px;height: 20px;\t}\t.img {padding: 50px;\t}\ttable {align-text: center;width: 100%;vertical-align: middle;border-top: 1px solid #ddd;border-left: 1px solid #ddd;\t}\ttable td,\ttable th {width: 20%;height: 40px;border-right: 1px solid #ddd;border-bottom: 1px solid #ddd;\t}\ttable p {text-indent: 0 !important;text-align: center;\t}",l=e.fileParams,d=h("#html-docx-config").html(),c=function(){var e=h("#page-header");h("#page-header").attr({data:e.html()}).html("");var t="";h("#first-page").length&&h("#page-content").length&&(t="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head></head><body>"+h(h("#first-page")).html().replace(/\s{2,}/g,"")+"</body></html>",h("#first-page").html(""));var n=h("#page-content");h('<br clear=all style="page-break-before:always" mce_style="page-break-before:always">').insertAfter(h(".change-line"));var r=h("#page-footer");return{header:{text:e.attr("data")||"",align:e.attr("textAlign")||"right"},footer:!!r.length,content:n.length,firstPage:t,titlePg:!(!h("#first-page").length||"true"!==h("#first-page").attr("titlePg"))}}(),f="#temporaryExportElement";h("<div id='temporaryExportElement'></div>").html(h(o).html()).appendTo(document.body),function(e,t){for(var n=h(e).find("canvas"),r=h(t).find("canvas"),o=0;o<n.length;o++){var i=h(r[o]).parent().parent(),a=n[o].toDataURL("image/jpg");h(i).empty(),h("<img/>").attr({src:a,width:h(n[o]).width(),height:h(n[o]).height()}).appendTo(i)}}(o,f),t=document.querySelectorAll("img"),n=document.createElement("canvas"),r=n.getContext("2d"),[].forEach.call(t,function(e){(e=new Image).setAttribute("crossOrigin","anonymous"),r.clearRect(0,0,n.width,n.height),n.width=e.width,n.height=e.height,r.drawImage(e,0,0);var t=n.toDataURL();e.setAttribute("src",t)}),n.remove();var s=l||{},u=["<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head></head><style>"+(a?a.replace(/(\s{2,}|\n)/g,""):"")+"</style><body>"+h(f).html().replace(/\s{2,}/g,"")+"</body></html>",c.firstPage];console.log(c);var m=g.asBlob(u,{margins:s.margins,config:c});h("#temporaryExportElement").remove(),p(m,i),c.firstPage&&h("#html-docx-config").html(d)}}();